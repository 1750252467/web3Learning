# 项目测试用例说明

## 测试用例概述

本项目的测试用例位于`tests`目录下，使用Go的标准测试框架和`github.com/stretchr/testify/assert`库编写。测试用例覆盖了项目的主要功能，包括用户认证、文章管理和评论管理等。

## 测试用例结构

目前已实现的测试用例包括：

1. `user_controller_test.go` - 用户控制器测试
   - 用户注册功能测试
   - 用户登录功能测试

2. `post_controller_test.go` - 文章控制器测试
   - 创建文章功能测试
   - 获取文章列表功能测试
   - 获取单篇文章功能测试
   - 更新文章功能测试
   - 删除文章功能测试

3. `comment_controller_test.go` - 评论控制器测试
   - 创建评论功能测试
   - 获取文章评论列表功能测试

## 运行测试用例

### 前提条件

1. 确保已安装Go（版本1.16或更高）
2. 确保已安装项目依赖

### 运行所有测试用例

在项目根目录（`note/task4`）下运行以下命令：

```bash
# 运行所有测试用例
go test ./tests/...

# 运行指定的测试文件
go test ./tests/user_controller_test.go

# 运行测试并显示详细输出
go test -v ./tests/...
```

### 运行单个测试函数

可以使用`-run`参数指定要运行的测试函数：

```bash
# 运行用户注册测试
go test -v ./tests/... -run TestUserRegister

# 运行文章创建测试
go test -v ./tests/... -run TestCreatePost
```

## 测试环境配置

测试用例使用SQLite内存数据库进行测试，不会影响实际的开发数据库。测试前会自动创建测试所需的表结构，测试后会自动清理。

## 测试用例设计原则

1. **独立性** - 每个测试用例独立运行，不依赖于其他测试用例的结果
2. **完整性** - 覆盖正常流程和异常情况
3. **可重复性** - 相同的测试用例多次运行应得到相同的结果
4. **可读性** - 测试用例名称和代码清晰易懂，便于维护

## 添加新的测试用例

如果需要添加新的测试用例，请遵循以下步骤：

1. 在`tests`目录下创建新的测试文件，命名格式为`xxx_test.go`
2. 使用Go的标准测试框架编写测试函数，函数名以`Test`开头
3. 使用`github.com/stretchr/testify/assert`库进行断言
4. 确保测试用例覆盖新功能的正常流程和异常情况

## 注意事项

1. 测试用例中使用了模拟的认证中间件，通过`X-Test-User-ID`请求头设置当前用户ID
2. 测试用例中使用SQLite内存数据库，无需手动创建和清理数据库
3. 运行测试前请确保已安装所有依赖包，可以通过`go mod tidy`命令安装

希望这些测试用例能够帮助你更好地理解和维护项目！